<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A collection of highly customizeable data visualizations for the web.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>mCharts - Examples - Bar</title>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <!--<link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">-->

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Material Design Lite">
    <!--<link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">-->

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <!--<meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">-->
    <meta name="msapplication-TileColor" content="#3372DF">

    <link href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://storage.googleapis.com/code.getmdl.io/1.0.2/material.blue-teal.min.css">

    <link rel="stylesheet" href="../mcharts.min.css">
    <link rel="stylesheet" href="../styles/styles.css">

    <style>

      .chartWrap {
        position: relative;
        margin: 0;
        padding: 0;
        float: left;
        width: 400px;
        height: 200px;
        margin: 10px;
      }
      .example {
        width: 400px;
        height: 200px;
      }

      #update {
        position: absolute;
        top: 8px;
        right: 8px;
      }

    </style>

  </head>
  <body class="mdl-demo mdl-color--grey-100 mdl-color-text--grey-700 mdl-base">

    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">

      <header class="mdl-layout__header mdl-layout__header--scroll mdl-color--primary">
        <div class="mdl-layout--large-screen-only mdl-layout__header-row">
        </div>
        <div class="mdl-layout--large-screen-only mdl-layout__header-row">
          <a href="http://bobmonteverde.github.io/mcharts"><img src="../images/mcharts-logo-white-64x64.svg" class="header-logo" /></a>
          <h3>mCharts.js</h3>
        </div>
        <div class="mdl-layout--large-screen-only mdl-layout__header-row">
        </div>
        <div class="mdl-layout__tab-bar mdl-js-ripple-effect mdl-color--primary-dark">
          <a href="/#overview" class="mdl-layout__tab-link">Overview</a>
          <a href="/#examples" class="mdl-layout__tab-link is-active">Examples</a>
          <a href="/#docs" class="mdl-layout__tab-link">Documentation</a>
          <a href="https://github.com/bobmonteverde/mcharts" class="mdl-layout__tab-link">Source</a>
          <a href="https://github.com/bobmonteverde/mcharts" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored mdl-shadow--4dp mdl-color--accent" id="download">
            <i class="material-icons">get_app</i>
          </a>
        </div>
      </header>


      <main class="mdl-layout__content">


        <div class="mdl-layout__tab-panel is-active" id="examples">

          <section class="section--center mdl-grid mdl-grid--no-spacing mdl-shadow--2dp">
            <div class="mdl-card mdl-cell mdl-cell--12-col">
              <div class="mdl-card__supporting-text mdl-grid mdl-grid--no-spacing">


                <!--<h4>Bar Charts</h4>-->

                <button id="update" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                  <i class="material-icons">refresh</i>
                </button>

                <div class="chartWrap mdl-shadow--3dp">
                  <svg id="example1" class="example example1"></svg>
                </div>
                <div class="chartWrap mdl-shadow--3dp">
                  <svg id="example1b" class="example example1"></svg>
                </div>
                <div class="chartWrap mdl-shadow--3dp">
                  <svg id="example2" class="example"></svg>
                </div>
                <div class="chartWrap mdl-shadow--3dp">
                  <svg id="example3" class="example"></svg>
                </div>
                <div class="chartWrap mdl-shadow--3dp">
                  <svg id="example4" class="example"></svg>
                </div>



              </div>
            </div>
          </section>


        </div>


        <footer class="mdl-mega-footer">
          <div class="mdl-mega-footer--bottom-section">
            <div class="mdl-logo">
              Library released under <a href="http://opensource.org/licenses/BSD-3-Clause">BSD license</a>. Copyright 2015 <a href="http://montev.com" rel="author">Bob Monteverde</a>.
            </div>
          </div>
        </footer>

      </main>
    </div>


    <script src="https://storage.googleapis.com/code.getmdl.io/1.0.2/material.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>

    <script src="../mcharts.min.js"></script>



    <script>

var now = new Date();

function sinData() {
  var data = [];

  now = new Date(now.getTime() + 500);

  for (var i = 0; i < 75; i++) {
    data.push({
      x: new Date(now.getTime() + i * 500),
      y: Math.sin((now.getTime() + i * 500)/5000)
    });
  }

  return [data];
}


function data(n, posOnly) {
  return stream_layers(n || 1,10,.1).map(function(data, i) {
  //return stream_layers(3,10+Math.random()*200,.1).map(function(data, i) {
    return {
      key: 'Stream' + i,
      values: data.map(function(d) {
            d.y = (posOnly ? 1 : (Math.random() - .5)) * d.y;
            return d;
          })
    };
  });
}

/* Inspired by Lee Byron's test data generator. */
function stream_layers(n, m, o) {
  if (arguments.length < 3) o = 0;
  function bump(a) {
    var x = 1 / (.1 + Math.random()),
        y = 2 * Math.random() - .5,
        z = 10 / (.1 + Math.random());
    for (var i = 0; i < m; i++) {
      var w = (i / m - y) * z;
      a[i] += x * Math.exp(-w * w);
    }
  }
  return d3.range(n).map(function() {
      var a = [], i;
      for (i = 0; i < m; i++) a[i] = o + o * Math.random();
      for (i = 0; i < 5; i++) bump(a);
      return a.map(stream_index);
    });
}

/* Another layer generator using gamma distributions. */
function stream_waves(n, m) {
  return d3.range(n).map(function(i) {
    return d3.range(m).map(function(j) {
        var x = 20 * j / m - i / 3;
        return 2 * x * Math.exp(-.5 * x);
      }).map(stream_index);
    });
}

function stream_index(d, i) {
  return {x: i, y: Math.max(0, d)};
}


    mc.render(function() {
      var chart  = mc.models.bar(),
          chart2 = mc.models.barGrouped(),
          chart3 = mc.models.barStacked(),
          chartWrap1  = d3.select('#example1'),
          chartWrap1b = d3.select('#example1b'),
          chartWraps1 = d3.selectAll('.example1'),
          chartWrap1  = d3.select('#example1'),
          chartWrap2  = d3.select('#example2'),
          chartWrap3  = d3.select('#example3'),
          chartWrap4  = d3.select('#example4')
          ;

      var i = 0;

      chart
        .margin({top: 40, right: 10, bottom: 10, left: 60})
        //.renderLeft(true) //default
        .renderAxes(true)
        .renderLegend(true)
        .rebind()
        .leftLabel('distance (cm)')
        .renderTop(true)
        .topLabel('group id (#)')
        //.legendVerticalAlign('top')
        //.renderRight(false) //default
        .renderBottom(false)

      //TODO: mc.rebind doesn't make components available
      //chart.legend
        //.height(40)

      chart2
        .margin({top: 40, right: 10, bottom: 30, left: 60})
        .renderAxes(true)
        .renderLegend(true)
        .rebind()
        //.renderRight(true)
        //.renderTop(true)
        //.renderLeft(false)
        //.renderBottom(false)

      chart3
        .margin({top: 40, right: 10, bottom: 30, left: 60})
        .renderAxes(true)
        .renderLegend(true)
        .rebind()

      // **udate() is used both for initial generating of charts as well as updating
      //   the charts with new data AND rotating bar models (chartWrap4)
      var update = function() {
        // Due to data being generated on the fly, render time in example may be higher than real render time
        chartWrap1
            .datum(data(1))

        chartWrap1b
            .datum(data(1))

        // **This is to demonstrate selection.each inside chart() functionality
        //     Multiple chart instances are generated from single chart settup
        //     and single call on a selectAll selection of all instances
        //     * data is unique, so set individually above
        chartWraps1
          .transition().duration(2000)
            .call(chart);

        chartWrap2
            .datum(data(Math.ceil(Math.random() * 3)))
          .transition().duration(2000)
            .call(chart2);

        chartWrap3
            //.datum(data(3, true))
            .datum(data(Math.ceil(Math.random() * 3), true))
          .transition().duration(2000)
            .call(chart3);

        // **chartWrap4 is to demonstrate 2 things:
        //   --it uses chart models previously used above on different instances
        //   --it shows transtioning smoothly between different models with the
        //     same elements arranged differently (barGrouped and barStacked)
        //     * both based off bar model with different layout calculation and
        //       tweaked Layers
        if (!i)
          chartWrap4
              .datum(data(3, true))
            .transition().duration(2000)
              .call(chart3);
        else
          chartWrap4
            .transition().duration(2000)
              .call(i % 2 ? chart2 : chart3);

        i++;
      }

      update();

      d3.select('#update').on('click', update);

      return chart;
    });


    </script>

  </body>
</html>
